#!/bin/sh

set -e

declare -a list_of_files=(
  ".git"
  ".gitconfig"
  ".githelpers"
  ".gitmodules"
  ".tmux.conf"
  ".vim"
  ".vimrc"
  ".Xdefaults"
  ".zlogin"
  ".zlogout"
  ".zprezto"
  ".zshenv"
  ".zshrc"
)

echo "==> Fetching sources..."
git clone --no-checkout git@github.com:AdrienGiboire/dotfiles.git .dotfiles &> /dev/null
wait $!

echo "==> Installing..."
cd ~/.dotfiles

# git thinks all files are deleted, this reverses that behaviour
git reset --hard HEAD &> /dev/null
wait $!

echo "==> Linking dotfiles..."
for file in "${list_of_files[@]}"; do
  if $verbose; then
    echo "====> Linking $file..."
  fi

  ln -s "~/.dotfiles/$file" "~/$file"
done

echo "==> Bootstrapping..."
./scripts/bootstrap

